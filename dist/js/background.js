(()=>{"use strict";chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch((function(e){return console.error(e)})),chrome.runtime.onInstalled.addListener((function(){chrome.runtime.openOptionsPage(),console.log("I just installed my chrome extension")})),chrome.runtime.onMessage.addListener((function(e,n,t){if("getResponse"===e.type){console.log("[Background] Getting response");var o=e.body,a=o.apiKey,r=o.model,i=o.responseType,s=o.format,c=o.readingLevel,l=o.length;chrome.storage.local.get("selectedText",(function(e){if(chrome.runtime.lastError)return console.error(chrome.runtime.lastError.message),void t({result:"Error retrieving selected text."});var n=e.selectedText;console.log("[Background] API_KEY: "+a),console.log("[Background] Model: "+r),console.log("[Background] Response Type: "+i),console.log("[Background] Content: "+n),console.log("[Background] Format: "+s),console.log("[Background] Reading Level: "+c),console.log("[Background] Length: "+l),function(e,n,t,o,a,r,i,s){var c="";"summarization"===t?(c="Task: Summarize the text provided after the triple backticks (```). Follow these guidelines:\n- Identify and extract the main ideas, key points, and essential information from the text.\n- Synthesize the content into a concise and coherent summary, maintaining the original meaning and context.\n- Use clear, concise, and easy-to-understand language, avoiding jargon or complex terminology.\n- Organize the summary logically, ensuring a smooth flow of information and coherence between points.\n- Retain the objectivity of the original text, without introducing personal opinions or biases.\n\nSummary Format:\n- Present the summary","bullet points"===a?c+=" as a well-structured list of bullet points.\n- Each bullet point should represent a key idea or topic from the text.\n- Use concise and informative phrases or sentences for each bullet point.\n- Maintain a parallel structure and consistent level of detail across all bullet points.":"paragraph"===a&&(c+=" in well-organized paragraphs.\n- Begin with a topic sentence that introduces the main idea of each paragraph.\n- Follow the topic sentence with supporting details, examples, or explanations.\n- Use transitional words or phrases to ensure smooth flow and logical connection between paragraphs.\n- Conclude the summary with a paragraph that ties together the main points and provides a final overview."),c+="\n\nReading Level: Tailor the summary to a","beginner"===r?c+=" 5th-grade reading level.\n- Use simple vocabulary and short, straightforward sentences.\n- Explain any complex concepts or terms in a way that is easily understandable for young readers.\n- Focus on the most essential information and avoid unnecessary details or abstractions.":"intermediate"===r?c+=" high school reading level.\n- Use clear, accessible language that is appropriate for a general audience.\n- Provide sufficient context and explanations to ensure comprehension of the main ideas.\n- Strike a balance between simplicity and depth, considering the reader's expected level of knowledge.":"advanced"===r&&(c+=" university graduate level.\n- Use precise, academic language and sophisticated vocabulary appropriate for a well-educated audience.\n- Engage with complex ideas, theories, or arguments presented in the text.\n- Provide nuanced explanations and insights, demonstrating a deep understanding of the subject matter."),c+="\n\nSummary Length:","concise"===i?c+=" Create a concise summary that captures the essence of the text.\n- Focus on the most critical points and main takeaways.\n- Omit minor details, examples, or peripheral information.\n- Aim for a word count of approximately 100-150 words.":"regular"===i?c+=" Develop a balanced and informative summary of the text.\n- Include the main ideas, key supporting points, and relevant details.\n- Provide sufficient context and explanations to ensure a comprehensive understanding.\n- Aim for a word count of approximately 250-300 words.":"detailed"===i&&(c+=" Craft a detailed and thorough summary that covers all significant aspects of the text.\n- Discuss each main idea in depth, providing extensive supporting details and examples.\n- Explore the nuances, implications, and connections between different concepts or arguments.\n- Use markdown headings to organize the summary into logical sections or themes.\n- Include a 'TL;DR' (Too Long; Didn't Read) section at the end, summarizing the key points in 1-2 concise paragraphs.\n- Aim for a word count of approximately 500-700 words."),c+="\n\nText to summarize: ```\n"):"questions"===t?c="Task: Generate 3 thought-provoking reflection questions based on the provided text.\n\nGuidelines:\n- Craft open-ended questions that stimulate critical thinking, analysis, and personal reflection.\n- Encourage readers to explore the deeper meanings, implications, or applications of the text.\n- Avoid questions that can be answered superficially or by simply restating information from the text.\n- Use clear, concise, and engaging language that invites thoughtful responses.\n\nQuestion Types:\n- Conceptual Questions: Focus on the key concepts, theories, or ideas presented in the text.\n  - Example: How does the author's theory of [concept] challenge conventional understanding of [related topic]?\n- Analytical Questions: Encourage readers to examine the text critically and draw their own conclusions.\n  - Example: What are the strengths and limitations of the evidence presented in support of [argument]?\n- Reflective Questions: Prompt readers to relate the text to their own experiences, beliefs, or values.\n  - Example: How has your perspective on [issue] evolved after reading this text, and why?\n\nText: ":"terms"===t&&(c="Task: Identify and define 5 key terms or concepts from the given text.\n\nInstructions:\n- Select terms that are central to understanding the main ideas, arguments, or themes of the text.\n- Choose terms that are specific, significant, and likely to be unfamiliar to readers.\n- Provide clear, accurate, and concise definitions that capture the essence of each term.\n- Use simple language and relatable examples to make the definitions accessible to a general audience.\n- Format each term and its definition as follows:\n  - Term: [Term]\n    Definition: [Definition]\n- Ensure that the definitions are self-contained and can be understood independently of the text.\n\nText: ");var l={model:n,messages:[{role:"user",content:c+o}]},d=JSON.stringify(l);fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"},body:d}).then((function(e){return e.ok?e.json():e.json().then((function(e){var n=e.error&&e.error.message?e.error.message:"Unknown error occurred.";throw e.error&&e.error.code&&(n+=" (Error Code: ".concat(e.error.code,")")),new Error(n)}))})).then((function(e){var n="No response";e.choices&&e.choices.length>0&&(n=e.choices[0].message.content),console.log("[Background] sending response: "+n),s({result:n})})).catch((function(e){console.error("API error: "+e.message),s({error:e.message})}))}(a,r,i,n,s,c,l,t)}))}return!0})),console.log("[Background] Loaded script"),chrome.runtime.onInstalled.addListener((function(){chrome.contextMenus.create({id:"captureSnippet",title:"Capture Snippet",contexts:["selection"]}),chrome.contextMenus.onClicked.addListener((function(e,n){if(console.log("[Background] Listening for onClicked"),"captureSnippet"===e.menuItemId){console.log("[Background] Captured Snippet");var t=e.selectionText;chrome.storage.local.set({selectedText:t})}}))}))})();